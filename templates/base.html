<!doctype html>
<html lang="en" class="h-100">
<head>
  <!-- Meta -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />

  <!-- SEO / Social -->
  <title>{% block title %}PittState-Connect{% endblock %}</title>
  <meta name="description" content="PittState-Connect ‚Äî scholarships, jobs, events & alumni networking for PSU." />
  <meta property="og:title" content="PittState-Connect" />
  <meta property="og:description" content="Scholarships, careers, events, and alumni networking ‚Äî all in one PSU-branded hub." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="{{ url_for('static', filename='img/og-card.png', _external=False) }}" />
  <meta name="theme-color" content="#a6192e" />

  <!-- Favicons (optional placeholders) -->
  <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') }}" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Montserrat:wght@700&display=swap" rel="stylesheet" />

  <!-- PSU Theme -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/psu-theme.css') }}" />

  <!-- Minimal utility styles (safe, no Tailwind required) -->
  <style>
    /* Layout helpers */
    .container { max-width: 1100px; margin: 0 auto; padding: 0 1rem; }
    .grid { display: grid; gap: 1rem; }
    .btn-outline { background: transparent; border: 1px solid #e5e7eb; color: #1a1a1a; }
    .btn-outline:hover { border-color: #a6192e; color: #a6192e; }
    .table { width: 100%; border-collapse: collapse; }
    .table th, .table td { padding: .65rem .8rem; border-bottom: 1px solid #eee; text-align: left; }

    /* Accessibility: focus outlines */
    a:focus, button:focus, input:focus, textarea:focus {
      outline: 3px solid #ffb81c; outline-offset: 2px;
    }

    /* Toasts */
    .psu-toast { position: fixed; right: 20px; bottom: 20px; z-index: 9999; border-radius: 12px; padding: 12px 16px;
                 color: #fff; font-weight: 600; box-shadow: 0 8px 24px rgba(0,0,0,.16); }
    .psu-toast.info  { background: #a6192e; }
    .psu-toast.warn  { background: #ffb81c; color:#222; }
    .psu-toast.error { background: #8c1628; }

    /* Skeleton shimmer (for loading states) */
    .skeleton { position: relative; overflow: hidden; background: #eee; border-radius: 8px; min-height: 1.25rem; }
    .skeleton::after { content:""; position:absolute; inset:0; transform: translateX(-100%);
      background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,.6) 50%, rgba(255,255,255,0) 100%);
      animation: shimmer 1.6s infinite; }
    @keyframes shimmer { 100% { transform: translateX(100%); } }

    /* Header shadow on scroll */
    .nav-glass { backdrop-filter: blur(6px); background: rgba(255,255,255,.75); }
    body.dark .nav-glass { background: rgba(30,30,30,.6); }
  </style>

  {% block head_extra %}{% endblock %}
</head>
<body class="min-h-screen">
  <!-- Accessibility: Skip link -->
  <a href="#main" class="btn btn-gold" style="position:absolute;left:-9999px;top:-9999px;"
     onfocus="this.style.left='12px';this.style.top='12px'">Skip to content</a>

  <!-- Header / Navbar -->
  <header id="site-header" class="nav-glass" style="position:sticky;top:0;z-index:100;border-bottom:1px solid rgba(0,0,0,.05);">
    <nav class="container" style="display:flex;align-items:center;justify-content:space-between;height:64px;">
      <div class="flex" style="display:flex;align-items:center;gap:.75rem;">
        <a href="{{ url_for('core_bp.home') }}" class="font-heading text-crimson" style="font-size:1.2rem;">
          ü¶ç PittState-Connect
        </a>
      </div>
      <div class="flex" style="display:flex;align-items:center;gap:1rem;">
        <a href="{{ url_for('core_bp.home') }}" class="hover:text-crimson">Home</a>
        <a href="/analytics" class="hover:text-crimson">Analytics</a>
        <a href="/donor/" class="hover:text-crimson">Donor</a>
        <a href="/employer/" class="hover:text-crimson">Employer</a>
        <a href="/admin/audit" class="hover:text-crimson">Admin</a>
        <!-- Global theme toggle (also respected by page-specific toggles) -->
        <button id="theme-toggle-global" class="btn btn-outline" title="Toggle dark mode">üåô</button>
      </div>
    </nav>
  </header>

  <!-- Flash messages -->
  <div class="container" aria-live="polite" aria-atomic="true" style="margin-top:1rem;">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="card" role="status" style="padding:.9rem;border-left:6px solid {% if category=='error' %}#8c1628{% elif category=='warning' %}#ffb81c{% else %}#a6192e{% endif %};">
            <strong style="margin-right:.4rem;text-transform:capitalize;">{{ category or 'info' }}:</strong> {{ message }}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}
  </div>

  <!-- Main content -->
  <main id="main" class="container section" style="padding-top:2rem;">
    {% block content %}
      <!-- Default landing skeleton (safe if a view forgets to extend) -->
      <div class="grid" style="grid-template-columns: 1fr 1fr;">
        <div class="card" style="padding:1rem;">
          <div class="skeleton" style="height:32px;width:60%;margin-bottom:.5rem;"></div>
          <div class="skeleton" style="height:16px;width:90%;margin-bottom:.35rem;"></div>
          <div class="skeleton" style="height:16px;width:80%;"></div>
        </div>
        <div class="card" style="padding:1rem;">
          <div class="skeleton" style="height:180px;width:100%;"></div>
        </div>
      </div>
    {% endblock %}
  </main>

  <!-- Footer -->
  <footer class="section-dark" style="padding:1.25rem 0;margin-top:2rem;">
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:1rem;flex-wrap:wrap;">
      <p class="font-body">¬© {{ 2025 }} Pittsburg State University ¬∑ PittState-Connect</p>
      <p class="font-body">
        <a href="/privacy" class="text-gold">Privacy</a> ¬∑
        <a href="/terms" class="text-gold">Terms</a>
      </p>
    </div>
  </footer>

  <!-- Vendor: Chart.js (for analytics pages) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Global helpers -->
  <script>
    // Toast helper (PSU-branded)
    window.psuToast = function (msg, type = "info") {
      try {
        const old = document.querySelector(".psu-toast"); if (old) old.remove();
        const el = document.createElement("div");
        el.className = `psu-toast ${type}`;
        el.textContent = msg;
        document.body.appendChild(el);
        setTimeout(() => { el.style.opacity = "0"; }, 3500);
        setTimeout(() => { el.remove(); }, 4200);
      } catch (e) { console.log(msg); }
    };

    // Persisted dark mode (shared with page-specific toggles)
    (function initTheme(){
      const saved = localStorage.getItem("theme");
      if (saved === "dark") document.body.classList.add("dark");
    })();

    // Header shadow on scroll (visual polish)
    (function headerShadow(){
      const hdr = document.getElementById("site-header");
      let on = false;
      window.addEventListener("scroll", () => {
        const should = window.scrollY > 6;
        if (should !== on) {
          on = should;
          hdr.style.boxShadow = on ? "0 6px 18px rgba(0,0,0,.07)" : "none";
        }
      });
    })();

    // Global theme button
    (function(){
      const btn = document.getElementById("theme-toggle-global");
      if (!btn) return;
      btn.addEventListener("click", () => {
        const isDark = document.body.classList.toggle("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
      });
    })();
  </script>

  <!-- AI client + Floating campus assistant -->
  <script src="{{ url_for('static', filename='js/ai-client.js') }}"></script>
  <script src="{{ url_for('static', filename='js/ai-helper-panel.js') }}"></script>

  {% block scripts %}{% endblock %}
</body>
</html>
