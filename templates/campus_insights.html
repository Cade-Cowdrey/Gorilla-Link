<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PittState Connect ‚Äî Campus in Numbers</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body { background: #f8f9fb; }
  .psu-crimson { color: #BA0C2F; }
  .psu-gold { color: #FFD200; }
  .card-counter .display-5 { font-weight: 800; }
  .hero { background: linear-gradient(90deg, #BA0C2F 0%, #8f0a23 100%); color: #FFD200; }
  .hero .lead { color: #fff1b5; }
</style>
</head>
<body>
  <header class="hero py-4">
    <div class="container">
      <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center">
        <div>
          <h1 class="mb-1">ü¶ç Campus in Numbers</h1>
          <p class="lead mb-0">Real-time snapshot of student & alumni engagement at PittState.</p>
        </div>
        <div class="text-end mt-3 mt-md-0">
          <a href="/" class="btn btn-light btn-sm">Go to Site</a>
        </div>
      </div>
    </div>
  </header>

  <main class="container my-4">

    <!-- Pride Score -->
    <div class="card shadow-sm mb-4">
      <div class="card-body text-center">
        <h5 class="fw-bold psu-crimson">üèÖ Gorilla Pride Index</h5>
        <canvas id="prideGauge" width="280" height="160"></canvas>
        <p class="mb-0 text-muted">Score: <strong id="prideScore">{{ metrics.pride }}</strong>/100 ‚Ä¢ Consistency: {{ metrics.consistency }}%</p>
      </div>
    </div>

    <!-- Counters -->
    <div class="row g-3 card-counter">
      <div class="col-6 col-md-3">
        <div class="card shadow-sm text-center">
          <div class="card-body">
            <div class="small text-muted">Total Users</div>
            <div class="display-5 psu-crimson">{{ metrics.total_users }}</div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card shadow-sm text-center">
          <div class="card-body">
            <div class="small text-muted">Active Students (7d)</div>
            <div class="display-5 psu-crimson">{{ metrics.active_students }}</div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card shadow-sm text-center">
          <div class="card-body">
            <div class="small text-muted">Alumni Profiles</div>
            <div class="display-5 psu-crimson">{{ metrics.alumni_count }}</div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card shadow-sm text-center">
          <div class="card-body">
            <div class="small text-muted">Mentors</div>
            <div class="display-5 psu-crimson">{{ metrics.mentors }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Highlights -->
    <div class="row g-3 mt-1">
      <div class="col-12 col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <div class="small text-muted">Growth (30d)</div>
            <h3 class="fw-bold {{ 'text-success' if metrics.growth>=0 else 'text-danger' }}">{{ metrics.growth }}%</h3>
            <p class="mb-0 text-muted">Total posts last 30 days: <strong>{{ metrics.month_posts }}</strong></p>
          </div>
        </div>
      </div>
      <div class="col-12 col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <div class="small text-muted">Top Department</div>
            <h4 class="fw-bold psu-crimson">{{ metrics.top_dept }}</h4>
            <p class="mb-0 text-muted">Based on post activity this month.</p>
          </div>
        </div>
      </div>
      <div class="col-12 col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <div class="small text-muted">Alumni Footprint</div>
            <h4 class="fw-bold psu-crimson">{{ metrics.alumni_states }} U.S. states</h4>
            <p class="mb-0 text-muted">Where alumni profiles are located.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- CTA -->
    <div class="text-center mt-4">
      <a href="{{ url_for('analytics.worldview') }}" class="btn btn-outline-danger">Explore the Gorilla Worldview</a>
    </div>
  </main>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const canvas = document.getElementById("prideGauge");
  const ctx = canvas.getContext("2d");
  const score = Number(document.getElementById("prideScore").textContent) || 0;
  const color = score >= 80 ? "#FFD200" : (score >= 60 ? "#ffca28" : "#BA0C2F");

  new Chart(ctx, {
    type: 'doughnut',
    data: { datasets: [{ data: [score, 100 - score], backgroundColor: [color, '#eee'], borderWidth: 0 }] },
    options: { circumference: 180, rotation: 270, cutout: '75%', plugins: { legend: { display: false }, tooltip: { enabled: false } } }
  });

  const mid = canvas.width / 2;
  const bottom = canvas.height * 0.78;
  ctx.font = "bold 22px Helvetica";
  ctx.fillStyle = "#BA0C2F";
  ctx.textAlign = "center";
  ctx.fillText(score + "/100", mid, bottom);
});
</script>
</body>
</html>
