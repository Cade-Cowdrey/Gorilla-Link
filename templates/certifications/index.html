{% extends "base.html" %}

{% block title %}Free Certifications - Boost Your Resume | Gorilla-Link{% endblock %}

{% block content %}
<div class="certifications-page">
    <!-- Hero Section -->
    <div class="hero-section bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-16">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-5xl font-bold mb-4">üéì Free Certifications Hub</h1>
            <p class="text-2xl mb-2">Industry-recognized certifications from Google, Microsoft, AWS, HubSpot & more</p>
            <p class="text-xl mb-8">Boost your resume with <strong>${{ '{:,.0f}'.format(total_value) }}</strong> in free training value</p>
            
            <div class="stats flex justify-center gap-8 mt-8">
                <div class="stat">
                    <div class="text-4xl font-bold">{{ total_certs }}</div>
                    <div class="text-sm opacity-90">Free Certifications</div>
                </div>
                <div class="stat">
                    <div class="text-4xl font-bold">${{ '{:,.0f}'.format(total_value) }}</div>
                    <div class="text-sm opacity-90">Total Training Value</div>
                </div>
                <div class="stat">
                    <div class="text-4xl font-bold">100%</div>
                    <div class="text-sm opacity-90">Free Forever</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Filters Section -->
    <div class="filters-section bg-white border-b sticky top-0 z-40 shadow-sm">
        <div class="container mx-auto px-4 py-4">
            <form method="get" action="{{ url_for('certifications.index') }}" class="flex flex-wrap gap-4 items-center">
                <!-- Category Filter -->
                <div class="filter-group">
                    <label class="text-sm font-semibold text-gray-700 mr-2">Category:</label>
                    <select name="category" class="border rounded px-3 py-2" onchange="this.form.submit()">
                        <option value="all" {% if selected_category == 'all' %}selected{% endif %}>All Categories</option>
                        {% for cat in categories %}
                        <option value="{{ cat }}" {% if selected_category == cat %}selected{% endif %}>{{ cat }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Provider Filter -->
                <div class="filter-group">
                    <label class="text-sm font-semibold text-gray-700 mr-2">Provider:</label>
                    <select name="provider" class="border rounded px-3 py-2" onchange="this.form.submit()">
                        <option value="all" {% if selected_provider == 'all' %}selected{% endif %}>All Providers</option>
                        {% for prov in providers %}
                        <option value="{{ prov }}" {% if selected_provider == prov %}selected{% endif %}>{{ prov }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Difficulty Filter -->
                <div class="filter-group">
                    <label class="text-sm font-semibold text-gray-700 mr-2">Difficulty:</label>
                    <select name="difficulty" class="border rounded px-3 py-2" onchange="this.form.submit()">
                        <option value="all" {% if selected_difficulty == 'all' %}selected{% endif %}>All Levels</option>
                        <option value="beginner" {% if selected_difficulty == 'beginner' %}selected{% endif %}>Beginner</option>
                        <option value="intermediate" {% if selected_difficulty == 'intermediate' %}selected{% endif %}>Intermediate</option>
                        <option value="advanced" {% if selected_difficulty == 'advanced' %}selected{% endif %}>Advanced</option>
                    </select>
                </div>

                <!-- Sort By -->
                <div class="filter-group">
                    <label class="text-sm font-semibold text-gray-700 mr-2">Sort by:</label>
                    <select name="sort" class="border rounded px-3 py-2" onchange="this.form.submit()">
                        <option value="popularity" {% if sort_by == 'popularity' %}selected{% endif %}>Most Popular</option>
                        <option value="duration_asc" {% if sort_by == 'duration_asc' %}selected{% endif %}>Shortest First</option>
                        <option value="duration_desc" {% if sort_by == 'duration_desc' %}selected{% endif %}>Longest First</option>
                        <option value="salary" {% if sort_by == 'salary' %}selected{% endif %}>Highest Salary Impact</option>
                    </select>
                </div>
            </form>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8">
        <!-- Featured Pathways -->
        {% if featured_pathways %}
        <div class="pathways-section mb-12">
            <h2 class="text-3xl font-bold mb-6">üéØ Featured Career Pathways</h2>
            <p class="text-gray-600 mb-6">Curated certification sequences to fast-track your career</p>
            
            <div class="grid md:grid-cols-3 gap-6">
                {% for pathway in featured_pathways %}
                <a href="{{ url_for('certifications.pathway_detail', id=pathway.id) }}" 
                   class="pathway-card bg-gradient-to-br from-blue-50 to-indigo-100 border-2 border-indigo-200 rounded-lg p-6 hover:shadow-xl transition-all">
                    <div class="flex items-start justify-between mb-3">
                        <h3 class="text-xl font-bold text-indigo-900">{{ pathway.title }}</h3>
                        <span class="bg-indigo-600 text-white px-3 py-1 rounded-full text-xs font-bold">
                            {{ pathway.total_certifications }} certs
                        </span>
                    </div>
                    <p class="text-gray-700 mb-4">{{ pathway.description[:120] }}...</p>
                    <div class="flex items-center justify-between text-sm">
                        <span class="text-indigo-700 font-semibold">
                            ‚è±Ô∏è {{ pathway.total_duration_hours }}h
                        </span>
                        <span class="text-green-700 font-bold">
                            üí∞ {{ pathway.target_salary_range }}
                        </span>
                    </div>
                </a>
                {% endfor %}
            </div>
            
            <div class="text-center mt-6">
                <a href="{{ url_for('certifications.pathways') }}" class="text-indigo-600 font-semibold hover:underline">
                    View All Career Pathways ‚Üí
                </a>
            </div>
        </div>
        {% endif %}

        <!-- Certifications Grid -->
        <div class="certifications-section">
            <h2 class="text-3xl font-bold mb-6">All Certifications ({{ certifications|length }})</h2>
            
            {% if certifications %}
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for cert in certifications %}
                <div class="cert-card bg-white border rounded-lg shadow-sm hover:shadow-lg transition-all overflow-hidden">
                    <!-- Provider Badge -->
                    <div class="provider-header bg-gray-50 px-4 py-2 flex items-center justify-between border-b">
                        <span class="text-sm font-semibold text-gray-700">{{ cert.provider }}</span>
                        {% if cert.is_featured %}
                        <span class="bg-yellow-400 text-yellow-900 px-2 py-1 rounded text-xs font-bold">‚≠ê FEATURED</span>
                        {% endif %}
                    </div>
                    
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2 text-gray-900">{{ cert.title }}</h3>
                        
                        <!-- Category & Subcategory -->
                        <div class="flex gap-2 mb-3">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-semibold">
                                {{ cert.category }}
                            </span>
                            {% if cert.subcategory %}
                            <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs">
                                {{ cert.subcategory }}
                            </span>
                            {% endif %}
                        </div>
                        
                        <p class="text-gray-600 text-sm mb-4 line-clamp-3">{{ cert.description }}</p>
                        
                        <!-- Skills -->
                        {% if cert.skills_gained %}
                        <div class="skills mb-4">
                            <div class="flex flex-wrap gap-1">
                                {% for skill in cert.skills_gained[:4] %}
                                <span class="bg-gray-100 text-gray-700 px-2 py-0.5 rounded text-xs">{{ skill }}</span>
                                {% endfor %}
                                {% if cert.skills_gained|length > 4 %}
                                <span class="text-gray-500 text-xs">+{{ cert.skills_gained|length - 4 }} more</span>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                        
                        <!-- Stats -->
                        <div class="stats-grid grid grid-cols-3 gap-2 mb-4 text-center">
                            <div>
                                <div class="text-lg font-bold text-indigo-600">{{ cert.duration_hours }}h</div>
                                <div class="text-xs text-gray-500">Duration</div>
                            </div>
                            <div>
                                <div class="text-lg font-bold text-green-600">{{ cert.resume_boost_score }}</div>
                                <div class="text-xs text-gray-500">Resume Score</div>
                            </div>
                            <div>
                                <div class="text-lg font-bold text-blue-600 capitalize">{{ cert.difficulty_level }}</div>
                                <div class="text-xs text-gray-500">Difficulty</div>
                            </div>
                        </div>
                        
                        <!-- Salary Impact -->
                        {% if cert.estimated_salary_boost %}
                        <div class="salary-impact bg-green-50 border border-green-200 rounded px-3 py-2 mb-4">
                            <div class="text-xs text-green-700 font-semibold">üí∞ Salary Impact</div>
                            <div class="text-sm text-green-900 font-bold">+${{ '{:,.0f}'.format(cert.estimated_salary_boost) }}</div>
                        </div>
                        {% endif %}
                        
                        <!-- Progress Bar (if enrolled) -->
                        {% if current_user.is_authenticated and cert.id in user_enrollments %}
                        <div class="progress mb-3">
                            <div class="flex justify-between text-xs mb-1">
                                <span class="text-gray-600">Your Progress</span>
                                <span class="text-indigo-600 font-bold">{{ user_enrollments[cert.id].progress_percentage }}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-indigo-600 h-2 rounded-full" style="width: {{ user_enrollments[cert.id].progress_percentage }}%"></div>
                            </div>
                        </div>
                        {% endif %}
                        
                        <!-- Actions -->
                        <div class="flex gap-2">
                            <a href="{{ url_for('certifications.detail', id=cert.id) }}" 
                               class="flex-1 bg-indigo-600 text-white px-4 py-2 rounded text-center font-semibold hover:bg-indigo-700 transition-colors">
                                View Details
                            </a>
                            {% if current_user.is_authenticated %}
                                {% if cert.id not in user_enrollments %}
                                <form method="post" action="{{ url_for('certifications.enroll', id=cert.id) }}" class="flex-1">
                                    <button type="submit" class="w-full bg-green-600 text-white px-4 py-2 rounded font-semibold hover:bg-green-700 transition-colors">
                                        Enroll
                                    </button>
                                </form>
                                {% else %}
                                <a href="{{ url_for('certifications.my_progress') }}" 
                                   class="flex-1 bg-gray-600 text-white px-4 py-2 rounded text-center font-semibold hover:bg-gray-700">
                                    Continue
                                </a>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-12">
                <p class="text-gray-600 text-lg">No certifications found matching your filters.</p>
                <a href="{{ url_for('certifications.index') }}" class="text-indigo-600 hover:underline mt-4 inline-block">
                    Clear filters
                </a>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
.line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.cert-card {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.cert-card > div:last-child {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.cert-card .flex.gap-2:last-child {
    margin-top: auto;
}
</style>
{% endblock %}
