{% extends "base.html" %}
{% block title %}Campus Feed | PittState-Connect{% endblock %}
{% block content %}
<section class="section section-light fade-in">
  <div class="container mx-auto">
    <h1 class="text-crimson font-heading mb-6 text-center">Campus Feed</h1>
    <p class="text-gray text-center mb-8">Share moments, updates, and celebrate your Gorilla community.</p>

    <!-- New Post Form -->
    <div class="card p-5 mb-8">
      <form id="postForm">
        <textarea class="w-full p-3 rounded border border-gray-300 focus:ring-2 focus:ring-crimson" rows="3" placeholder="What's on your mind?"></textarea>
        <div class="flex justify-end mt-3">
          <button type="submit" class="btn btn-gold">Post Update</button>
        </div>
      </form>
    </div>

    <!-- Feed Posts -->
    {% for post in posts %}
    <div class="card p-5 mb-5 fade-in">
      <div class="flex items-center justify-between mb-2">
        <h3 class="font-heading text-crimson">{{ post.user }}</h3>
        <small class="text-gray">{{ post.time }}</small>
      </div>
      <p class="mb-3">{{ post.content }}</p>
      <div class="flex items-center space-x-4">
        <button class="text-crimson hover:text-gold transition"><i class="fa-solid fa-heart"></i> Like</button>
        <button class="text-crimson hover:text-gold transition"><i class="fa-solid fa-comment"></i> Comment</button>
        <button class="text-crimson hover:text-gold transition"><i class="fa-solid fa-share"></i> Share</button>
      </div>
    </div>
    {% endfor %}

    <!-- Optional Enhancement: AI Feed Summary -->
    <div class="card p-5 mt-10 text-center fade-in">
      <h3 class="font-heading text-crimson mb-3">AI Summary</h3>
      <p class="text-gray mb-3">Curious about campus sentiment this week?</p>
      <button id="aiSummaryBtn" class="btn btn-crimson">Generate Weekly Summary</button>
      <p id="aiSummaryText" class="mt-3 text-sm text-gray hidden"></p>
    </div>
  </div>
</section>
<script>
document.getElementById('aiSummaryBtn').addEventListener('click', async () => {
  const res = await fetch('/api/ai/summary');
  const data = await res.json();
  const out = document.getElementById('aiSummaryText');
  out.textContent = data.summary || "No summary available.";
  out.classList.remove('hidden');
});
</script>
{% endblock %}
