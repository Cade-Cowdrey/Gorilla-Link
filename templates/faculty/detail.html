{% extends "base.html" %}
{% block title %}{{ faculty.name }} | PittState-Connect{% endblock %}
{% block content %}

<section class="container mx-auto px-4 py-8">
  <!-- HEADER -->
  <div class="text-center mb-10">
    <h1 class="text-4xl font-bold text-crimson mb-2">{{ faculty.name }}</h1>
    <p class="text-gray-600 text-lg mb-4">
      {{ faculty.title or "Faculty Member" }} – {{ faculty.department.name if faculty.department else "Pittsburg State University" }}
    </p>
    <div class="flex justify-center gap-4">
      <a href="{{ safe_url_for('departments_bp.detail', slug=faculty.department.slug) }}"
         class="px-4 py-2 bg-crimson text-white rounded-xl shadow-md hover:bg-gold hover:text-crimson transition">
        ← Back to {{ faculty.department.name if faculty.department else "Department" }}
      </a>
      <a href="{{ safe_url_for('analytics_bp.index') }}"
         class="px-4 py-2 bg-gold text-crimson rounded-xl shadow-md hover:bg-crimson hover:text-gold transition">
        View Analytics
      </a>
    </div>
  </div>

  <!-- PROFILE -->
  <div class="bg-white rounded-2xl shadow-md border-t-4 border-gold p-8 max-w-4xl mx-auto">
    <div class="flex flex-col md:flex-row items-center md:items-start gap-8">
      <img src="{{ faculty.profile_image_url or url_for('static', filename='img/default-avatar.png') }}"
           alt="{{ faculty.name }}"
           class="w-40 h-40 rounded-full border border-gray-300 object-cover shadow-sm">
      <div class="flex-1 text-left">
        <h2 class="text-2xl font-semibold text-crimson mb-2">{{ faculty.name }}</h2>
        <p class="text-gray-600 mb-4">{{ faculty.title or "Faculty Member" }}</p>

        <ul class="space-y-2 text-sm text-gray-700">
          {% if faculty.email %}
          <li><strong>Email:</strong>
            <a href="mailto:{{ faculty.email }}" class="text-gold hover:text-crimson transition">{{ faculty.email }}</a>
          </li>
          {% endif %}
          {% if faculty.phone %}
          <li><strong>Phone:</strong> {{ faculty.phone }}</li>
          {% endif %}
          {% if faculty.office_location %}
          <li><strong>Office:</strong> {{ faculty.office_location }}</li>
          {% endif %}
          {% if faculty.office_hours %}
          <li><strong>Office Hours:</strong> {{ faculty.office_hours }}</li>
          {% endif %}
          <li><strong>Last Updated:</strong> {{ faculty.updated_at.strftime('%b %d, %Y') if faculty.updated_at else "Recently" }}</li>
        </ul>
      </div>
    </div>

    <!-- BIO -->
    <div class="mt-8 border-t border-gray-200 pt-6">
      <h3 class="text-xl font-semibold text-crimson mb-3">About {{ faculty.name.split(' ')[0] }}</h3>
      <p class="text-gray-700 leading-relaxed">
        {{ faculty.bio or "This faculty member's biography is not yet available." }}
      </p>
    </div>

    <!-- RESEARCH -->
    {% if faculty.research_interests %}
    <div class="mt-8 border-t border-gray-200 pt-6">
      <h3 class="text-xl font-semibold text-crimson mb-3">Research Interests</h3>
      <ul class="list-disc pl-6 text-gray-700 space-y-1">
        {% for topic in faculty.research_interests.split(',') %}
        <li>{{ topic.strip() }}</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

    <!-- COURSES -->
    {% if faculty.courses_taught %}
    <div class="mt-8 border-t border-gray-200 pt-6">
      <h3 class="text-xl font-semibold text-crimson mb-3">Courses Taught</h3>
      <ul class="list-disc pl-6 text-gray-700 space-y-1">
        {% for course in faculty.courses_taught.split(',') %}
        <li>{{ course.strip() }}</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

    <!-- ANALYTICS CARD -->
    {% include "faculty/_analytics_card.html" %}
  </div>

  <!-- FOOTER -->
  <div class="mt-12 text-center text-gray-500 text-sm">
    <p>Back to
      <a href="{{ safe_url_for('departments_bp.detail', slug=faculty.department.slug) }}"
         class="text-gold hover:text-crimson font-semibold">Department Page</a>
    </p>
    <p class="mt-2">PittState-Connect © {{ now().year }}</p>
  </div>
</section>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" crossorigin="anonymous"></script>
<script src="{{ url_for('static', filename='js/faculty_analytics.js') }}"></script>

{% endblock %}
