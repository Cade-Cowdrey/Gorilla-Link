{% extends "base_psu.html" %}

{% block title %}Find a Mentor - PSU Connect{% endblock %}

{% block content %}
<div class="container" style="max-width: 1200px; padding: 2rem 0;">
    <div style="text-align: center; margin-bottom: 3rem;">
        <h1 style="color: var(--psu-crimson); margin-bottom: 1rem;">
            <i class="fas fa-user-friends"></i> Find Your Career Mentor
        </h1>
        <p style="font-size: 1.1rem; color: #6c757d;">Connect with experienced professionals and alumni</p>
    </div>

    <!-- Navigation -->
    <div style="display: flex; gap: 1rem; margin-bottom: 2rem; justify-content: center; flex-wrap: wrap;">
        <a href="/mentorship" class="btn-secondary">
            <i class="fas fa-home"></i> Programs
        </a>
        <a href="/mentorship/find-mentor" class="btn-primary">
            <i class="fas fa-search"></i> Find Mentor
        </a>
        <a href="/mentorship/become-mentor" class="btn-secondary">
            <i class="fas fa-graduation-cap"></i> Become Mentor
        </a>
        <a href="/mentorship/mentor/dashboard" class="btn-secondary">
            <i class="fas fa-th-large"></i> My Dashboard
        </a>
    </div>

    <!-- AI Match Recommendations -->
    {% if recommended_mentors %}
    <div class="psu-card" style="padding: 2rem; margin-bottom: 2rem; background: linear-gradient(135deg, rgba(139,26,26,0.05) 0%, rgba(253,181,21,0.05) 100%);">
        <h3 style="color: var(--psu-crimson); margin: 0 0 1rem 0;">
            <i class="fas fa-star"></i> AI-Recommended Matches
        </h3>
        <p style="color: #6c757d; margin-bottom: 1.5rem;">
            Based on your profile, major, and career interests
        </p>

        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
            {% for mentor in recommended_mentors %}
            <div class="psu-card" style="padding: 1.5rem; border: 2px solid var(--psu-gold);">
                <div style="display: flex; align-items: start; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 60px; height: 60px; border-radius: 50%; background: var(--psu-crimson); color: white; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold;">
                        {{ mentor.user.full_name[0] }}
                    </div>
                    <div style="flex: 1;">
                        <h4 style="margin: 0 0 0.25rem 0; color: var(--psu-crimson);">{{ mentor.user.full_name }}</h4>
                        <div style="font-size: 0.9rem; color: #6c757d;">{{ mentor.current_position }}</div>
                        <div style="font-size: 0.85rem; color: #6c757d;">{{ mentor.company }}</div>
                    </div>
                </div>

                <!-- Match Score -->
                <div style="text-align: center; margin: 1rem 0; padding: 0.75rem; background: var(--psu-gold); color: white; border-radius: 0.5rem; font-weight: 600;">
                    <i class="fas fa-star"></i> {{ mentor.match_score }}% Match
                </div>

                <!-- Expertise -->
                <div style="margin-bottom: 1rem;">
                    <strong style="font-size: 0.9rem; color: var(--psu-crimson);">Expertise:</strong>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 0.5rem;">
                        {% for area in mentor.expertise_areas[:3] %}
                        <span style="background: #f8f9fa; color: #6c757d; padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.85rem;">
                            {{ area }}
                        </span>
                        {% endfor %}
                    </div>
                </div>

                <!-- Bio Preview -->
                <p style="font-size: 0.9rem; color: #6c757d; margin-bottom: 1rem; line-height: 1.5;">
                    {{ mentor.bio[:100] }}...
                </p>

                <!-- Action -->
                <button onclick="requestMentor({{ mentor.id }})" class="btn-primary" style="width: 100%;">
                    <i class="fas fa-paper-plane"></i> Request Mentorship
                </button>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Browse All Mentors -->
    <div class="psu-card" style="padding: 2rem;">
        <h3 style="color: var(--psu-crimson); margin: 0 0 1rem 0;">
            <i class="fas fa-list"></i> Browse All Mentors
        </h3>

        <!-- Filters -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
            <select id="industryFilter" class="psu-input" onchange="applyFilters()">
                <option value="">All Industries</option>
                <option>Technology</option>
                <option>Business</option>
                <option>Education</option>
                <option>Healthcare</option>
                <option>Engineering</option>
            </select>
            <select id="expertiseFilter" class="psu-input" onchange="applyFilters()">
                <option value="">All Expertise</option>
                <option>Career Guidance</option>
                <option>Interview Prep</option>
                <option>Resume Building</option>
                <option>Networking</option>
                <option>Technical Skills</option>
            </select>
            <select id="availabilityFilter" class="psu-input" onchange="applyFilters()">
                <option value="">Any Availability</option>
                <option>Immediate</option>
                <option>Within 1 week</option>
                <option>Within 1 month</option>
            </select>
        </div>

        <!-- Mentor List -->
        <div id="mentorList" style="display: grid; gap: 1rem;">
            {% for mentor in all_mentors %}
            <div class="psu-card" style="padding: 1.5rem;">
                <div style="display: grid; grid-template-columns: auto 1fr auto; gap: 1.5rem; align-items: center;">
                    <!-- Avatar -->
                    <div style="width: 80px; height: 80px; border-radius: 50%; background: var(--psu-crimson); color: white; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold;">
                        {{ mentor.user.full_name[0] }}
                    </div>

                    <!-- Info -->
                    <div>
                        <h4 style="margin: 0 0 0.5rem 0; color: var(--psu-crimson);">{{ mentor.user.full_name }}</h4>
                        <div style="font-size: 0.95rem; color: #6c757d; margin-bottom: 0.25rem;">
                            <i class="fas fa-briefcase"></i> {{ mentor.current_position }} at {{ mentor.company }}
                        </div>
                        <div style="font-size: 0.9rem; color: #6c757d; margin-bottom: 0.5rem;">
                            <i class="fas fa-industry"></i> {{ mentor.industry }}
                        </div>
                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            {% for area in mentor.expertise_areas[:4] %}
                            <span style="background: #f8f9fa; color: #6c757d; padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.85rem;">
                                {{ area }}
                            </span>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Action -->
                    <div style="min-width: 150px;">
                        <button onclick="requestMentor({{ mentor.id }})" class="btn-primary" style="width: 100%; margin-bottom: 0.5rem;">
                            <i class="fas fa-paper-plane"></i> Request
                        </button>
                        <button onclick="viewProfile({{ mentor.id }})" class="btn-secondary" style="width: 100%;">
                            <i class="fas fa-user"></i> Profile
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<script>
function requestMentor(mentorId) {
    if (!confirm('Send mentorship request to this mentor?')) return;
    
    fetch('/mentorship/request-mentor', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            mentor_id: mentorId
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Request sent! You will be notified when the mentor responds.');
            location.reload();
        } else {
            alert('Error: ' + (data.error || 'Failed to send request'));
        }
    });
}

function viewProfile(mentorId) {
    window.location.href = '/mentorship/mentor/' + mentorId;
}

function applyFilters() {
    const industry = document.getElementById('industryFilter').value;
    const expertise = document.getElementById('expertiseFilter').value;
    const availability = document.getElementById('availabilityFilter').value;
    
    // Apply filters (implement filtering logic)
    console.log('Filters:', {industry, expertise, availability});
}
</script>
{% endblock %}
